#Test ID:AN_53647_InvoicewithServiceItem_AttachmentAtLinelevel_SupplierGroupBased
#Test Description: AN_53647_InvoicewithServiceItem_AttachmentAtLinelevel_SupplierGroupBased
"setTimeout","60000",""
#Open the supplier test central page
"open","/Supplier.aw/ad/testCentral",""
#Create Buyer
"clickAndWait","[@awname='createTestBuyer::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_userId_field=userId::MetaForm:refreshCurrentPage']","selbuy_DV_N_buy_@b.c"
"click","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_autoAcceptTOU_field=autoAcceptTOU::MetaForm:refreshCurrentPage']",""
"click","[@awname='TestStagerForm:runStager']",""
"waitForPageToLoad","360000",""
#Create Supplier 1
"clickAndWait","[@awname='createTestSupplier::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_userId_field=userId::MetaForm:refreshCurrentPage']","selsup_DV_N_sup1_@s.c"
"click","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_autoAcceptTOU_field=autoAcceptTOU::MetaForm:refreshCurrentPage']",""
"click","[@awname='TestStagerForm:runStager']",""
"waitForPageToLoad","360000",""
#Create Relationship
"clickAndWait","[@awname='createSupplierBuyerRelationship::TestCategoryLinks:testUnitClick']",""
#wait for supplier / buyer to replicate 
"clickAndWait","[@awname='waitForSupplierToReplicate::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='waitForBuyerToReplicate::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='waitForRelationshipToReplicate::TestCategoryLinks:testUnitClick']",""
#Create Supplier 2
"clickAndWait","[@awname='createTestSupplier::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_userId_field=userId::MetaForm:refreshCurrentPage']","selsup_DV_N_sup2_@s.c"
"click","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_autoAcceptTOU_field=autoAcceptTOU::MetaForm:refreshCurrentPage']",""
"click","[@awname='TestStagerForm:runStager']",""
"waitForPageToLoad","360000",""
#Create Relationship
"clickAndWait","[@awname='createSupplierBuyerRelationship::TestCategoryLinks:testUnitClick']",""
#wait for supplier / buyer to replicate 
"clickAndWait","[@awname='waitForSupplierToReplicate::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='waitForBuyerToReplicate::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='waitForRelationshipToReplicate::TestCategoryLinks:testUnitClick']",""
#Setting Buyer As context
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentralASN_Buyer']",""
"type","[@awname='ANTestUserManager:newUsername']","selbuy_DV_N_buy_@b.c"
"clickAndWait","[@awname='ANTestUserManager:changeUser']",""
#Navigating To Buyer Home page
#Setting Rule "Required attachment for Invoice with service item"
"clickAndWait","[@awname='buyerHomePage::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='AribaAction:preferences:actionClicked']",""
"clickAndWait","[@awname='buyerConfig_Transactions']",""
"clickAndWait","[@awname='CBInvoiceRuleSetup:checkboxClicked']",""
"clickAndWait","[@awname='CBInvoiceSetup:checkboxClicked']",""
"clickAndWait","[@awname='ModalPageWrapper:okClicked_1']",""
"clickAndWait","[@awname='ModalPageWrapper:okClicked']",""
#Creating Group supplier using stager
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentral_']",""
"clickAndWait","[@awname='createSupplierGroup::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.apps.buyer.testutils.SupplierGroupParams_supplierGroup_field=supplierGroup::MetaForm:refreshCurrentPage']","Group1"
"type","[@awname='class=ariba.network.service.apps.buyer.testutils.SupplierGroupParams_supplierUserId_field=supplierUserId::MetaForm:refreshCurrentPage']","selsup_DV_N_sup1_@s.c"
"click","[@awname='TestStagerForm:runStager']",""
"waitForPageToLoad","360000",""
#Setting Supplier Group level Rules
"clickAndWait","[@awname='buyerHomePage::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='PTSGlobalTOC:tabClicked_4']",""
"clickAndWait","[@awname='PTSGlobalCommandBar:tabClicked_4']",""
"assertText","[@awname='ANXDataTable:currentColumn.xml.action']","Group1"
"clickAndWait","[@awname='ANXDataTable:currentColumn.xml.action']",""
"clickAndWait","[@awname='SSSupplierGroup:editInvoiceRule']",""
"click","[@awname='selectedItem::SSPGroupInvoiceRule:YES']",""
"clickAndWait","[@awname='CBInvoiceRuleSetup:checkboxClicked']",""
"click","[@awname='CBInvoiceRuleSetup:requireSvcInvAttachments']",""
"clickAndWait","[@awname='ModalPageWrapper:okClicked']",""
"clickAndWait","[@awname='ModalPageWrapper:okClicked']",""
#CASE1
#set the supplier to the test context
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentralASN_Supplier']",""
"type","[@awname='ANTestUserManager:newUsername']","selsup_DV_N_sup2_@s.c"
"clickAndWait","[@awname='ANTestUserManager:changeUser']",""
#Run CreatePO stager
"clickAndWait","[@awname='createPO::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.apps.supplier.testutils.POStagerParameter_buyerUserId_field=buyerUserId::MetaForm:refreshCurrentPage']","selbuy_DV_N_buy_@b.c"
"select","[@awname='class=ariba.network.service.apps.supplier.testutils.POStagerParameter_poType_field=poType::MetaForm:list']","label=General Service"
"clickAndWait","[@awname='TestStagerForm:runStager']",""
"clickAndWait","[@awname='waitForProcessedDocument::TestCategoryLinks:testUnitClick']",""
#Go to PO details page
"clickAndWait","[@awname='showDocumentUI::TestCategoryLinks:testUnitClick']",""
#New Step from here
"click","[@awname='INSPOActions:refreshCurrentPage_1']",""
"clickAndWait","[@awname='INSPOActions:standardInvoiceClicked']",""
"type","[@awname='___INTERNAL_Invoice Header Quick Entry____INTERNAL_Invoice Header Summary Row____INTERNAL_SummaryFields____INTERNAL_InvoiceRemitToBillTo____INTERNAL_Invoice Header Common____INTERNAL_orderInfo_InvoiceDetailRequestHeader.invoiceID::InvoiceDetailRequestHeader.invoiceID']","INV_DV_N_foo_"
"type","[@awname='___INTERNAL_Invoice Header Quick Entry____INTERNAL_Invoice Header Tax_InvoiceDetailSummary.Tax_TaxDetail____INTERNAL_TaxDetail____INTERNAL_TaxDetailAction____INTERNAL_TaxDetailColumn2_percentageRate::percentageRate']","2"
"click","[@awname='InvoiceDetailItem::NCFGroupView:selected']",""
"clickAndWait","[@awname='next::WizardNavigator:actionClicked_1']",""
"clickAndWait","[@awname='submit::WizardNavigator:actionClicked']",""
#Processed Doc
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentral_']",""
"clickAndWait","[@awname='waitForProcessedDocument::TestCategoryLinks:testUnitClick']",""
#Validating Doc status
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:testValidation']",""
"type","[@awname='AUTOMATION_VALIDATION_ENTRY_STRING']","{""validationMethod"":""ariba.network.service.apps.supplier.testutils.FWTest,inspectDoc,ariba.network.service.common.antxnbusinesslogic.ANCXMLDocument,ariba.network.service.common.antxnbusinesslogic.ANCXMLDocument"",""validationParameters"":""{\""validationParameters\"":[{\""validateOrder\"":false,\""name\"":\""documentType\"",\""value\"":\""InvoiceDetailRequest\"",\""list\"":false,\""objectList\"":false,\""key\"":\""documentType\""},{\""validateOrder\"":false,\""name\"":\""documentStatus\"",\""value\"":\""<null>\"",\""list\"":false,\""objectList\"":false,\""key\"":\""documentStatus\""},{\""validateOrder\"":false,\""name\"":\""status\"",\""value\"":\""Sent\"",\""list\"":false,\""objectList\"":false,\""key\"":\""status\""},{\""validateOrder\"":false,\""name\"":\""amountAmount\"",\""value\"":\""<null>\"",\""list\"":false,\""objectList\"":false,\""key\"":\""amountAmount\""},{\""validateOrder\"":false,\""name\"":\""amountCurrency\"",\""value\"":\""<null>\"",\""list\"":false,\""objectList\"":false,\""key\"":\""amountCurrency\""},{\""validateOrder\"":false,\""name\"":\""dashboardStatus\"",\""value\"":\""INVOICE_SENT\"",\""list\"":false,\""objectList\"":false,\""key\"":\""dashboardStatus\""}]}""}"
"clickAndWait","[@awname='AUTOMATION_COMPARE_VALIDATION']",""
"clickAndWait","[@awname='AUTOMATION_VALIDATION_SUCCESS']",""
#CASE 2
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentralASN_Supplier']",""
"type","[@awname='ANTestUserManager:newUsername']","selsup_DV_N_sup1_@s.c"
"clickAndWait","[@awname='ANTestUserManager:changeUser']",""
#Run CreatePO stager
"clickAndWait","[@awname='createPO::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.apps.supplier.testutils.POStagerParameter_buyerUserId_field=buyerUserId::MetaForm:refreshCurrentPage']","selbuy_DV_N_buy_@b.c"
"select","[@awname='class=ariba.network.service.apps.supplier.testutils.POStagerParameter_poType_field=poType::MetaForm:list']","label=General Service"
"clickAndWait","[@awname='TestStagerForm:runStager']",""
"clickAndWait","[@awname='waitForProcessedDocument::TestCategoryLinks:testUnitClick']",""
#Go to PO details page
"clickAndWait","[@awname='showDocumentUI::TestCategoryLinks:testUnitClick']",""
#Invoice Creation
"click","[@awname='INSPOActions:refreshCurrentPage_1']",""
"clickAndWait","[@awname='INSPOActions:standardInvoiceClicked']",""
"type","[@awname='___INTERNAL_Invoice Header Quick Entry____INTERNAL_Invoice Header Summary Row____INTERNAL_SummaryFields____INTERNAL_InvoiceRemitToBillTo____INTERNAL_Invoice Header Common____INTERNAL_orderInfo_InvoiceDetailRequestHeader.invoiceID::InvoiceDetailRequestHeader.invoiceID']","INV2_DV_N_foo_"
"type","[@awname='___INTERNAL_Invoice Header Quick Entry____INTERNAL_Invoice Header Tax_InvoiceDetailSummary.Tax_TaxDetail____INTERNAL_TaxDetail____INTERNAL_TaxDetailAction____INTERNAL_TaxDetailColumn2_percentageRate::percentageRate']","3"
"click","[@awname='InvoiceDetailItem::NCFGroupView:selected']",""
"click","[@awname='InvoiceDetailItem::NCFGroupView:refreshCurrentPage']",""
"clickAndWait","[@awname='InvoiceDetailItem_____INTERNALACTION_$[StandardInvoiceItems/a082]Attachment::Attachment:clicked']",""
"clickAndWait","[@awname='InvoiceDetailItem____INTERNAL_Service Item Attachment_____INTERNALAW_attachment::INSGenerateLineAttachment:addAttachmentClicked']",""
"click","[@awname='InvoiceDetailItem::AWRefreshRegion_6']",""
"assertTextPresent","File path is not specified",""
"click","[@awname='InvoiceDetailItem____INTERNAL_Service Item Attachment_____INTERNALAW_attachment::AWFileUploadInternals']",""
"click","[@awname='InvoiceDetailItem____INTERNAL_Service Item Attachment_____INTERNALAW_attachment::AWFileUploadInternals']",""
"click","[@awname='InvoiceDetailItem____INTERNAL_Service Item Attachment_____INTERNALAW_attachment::AWFileUploadInternals']",""
"typefilename","[@awname='InvoiceDetailItem____INTERNAL_Service Item Attachment_____INTERNALAW_attachment::AWFileUploadInternals']","testData/LineAttachment.txt"
"clickAndWait","[@awname='InvoiceDetailItem____INTERNAL_Service Item Attachment_____INTERNALAW_attachment::INSGenerateLineAttachment:addAttachmentClicked']",""
"click","[@awname='InvoiceDetailItem::AWRefreshRegion_6']",""
"assertTextPresent"," LineAttachment.txt ",""
"clickAndWait","[@awname='next::WizardNavigator:actionClicked_1']",""
"clickAndWait","[@awname='submit::WizardNavigator:actionClicked']",""
#Processed Doc
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentral_']",""
"clickAndWait","[@awname='waitForProcessedDocument::TestCategoryLinks:testUnitClick']",""
#Assertion for attachement
"clickAndWait","[@awname='showDocumentUI::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='TXNPageWrapperContent:wrapper.returnPage']",""
"clickAndWait","[@awname='showDocumentUI::TestCategoryLinks:testUnitClick']",""
"assertText","[@awname='ANXDataTable:currentColumn.xml.action']","LineAttachment.txt"
#incoice validation
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentral_']",""
"clickAndWait","[@awname='waitForProcessedDocument::TestCategoryLinks:testUnitClick']",""
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:testValidation']",""
"type","[@awname='AUTOMATION_VALIDATION_ENTRY_STRING']","{""validationMethod"":""ariba.network.service.apps.supplier.testutils.FWTest,inspectDoc,ariba.network.service.common.antxnbusinesslogic.ANCXMLDocument,ariba.network.service.common.antxnbusinesslogic.ANCXMLDocument"",""validationParameters"":""{\""validationParameters\"":[{\""validateOrder\"":false,\""name\"":\""documentType\"",\""value\"":\""InvoiceDetailRequest\"",\""list\"":false,\""objectList\"":false,\""key\"":\""documentType\""},{\""validateOrder\"":false,\""name\"":\""documentStatus\"",\""value\"":\""<null>\"",\""list\"":false,\""objectList\"":false,\""key\"":\""documentStatus\""},{\""validateOrder\"":false,\""name\"":\""status\"",\""value\"":\""Sent\"",\""list\"":false,\""objectList\"":false,\""key\"":\""status\""},{\""validateOrder\"":false,\""name\"":\""amountAmount\"",\""value\"":\""<null>\"",\""list\"":false,\""objectList\"":false,\""key\"":\""amountAmount\""},{\""validateOrder\"":false,\""name\"":\""amountCurrency\"",\""value\"":\""<null>\"",\""list\"":false,\""objectList\"":false,\""key\"":\""amountCurrency\""},{\""validateOrder\"":false,\""name\"":\""dashboardStatus\"",\""value\"":\""INVOICE_SENT\"",\""list\"":false,\""objectList\"":false,\""key\"":\""dashboardStatus\""}]}""}"
"clickAndWait","[@awname='AUTOMATION_COMPARE_VALIDATION']",""
"clickAndWait","[@awname='AUTOMATION_VALIDATION_SUCCESS']",""
"clickAndWait","[@awname='showDocumentUI::TestCategoryLinks:testUnitClick']",""
"assertText","[@awname='ANXDataTable:currentColumn.xml.action']","LineAttachment.txt"
