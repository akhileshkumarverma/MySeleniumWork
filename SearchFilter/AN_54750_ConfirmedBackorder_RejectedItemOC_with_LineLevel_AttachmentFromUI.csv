#AN_53646_47_InvoiceWithServiceItem_Attachment_CXMLPosterAN-3234:Ez-Create OC
#Test Description: AN_53646_47_InvoiceWithServiceItem_Attachment_CXMLPoster
"setTimeout","60000",""
#Open the supplier test central page
"open","/Supplier.aw/ad/testCentral",""
#Create Supplier
"clickAndWait","[@awname='createTestSupplier::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_userId_field=userId::MetaForm:refreshCurrentPage']","selsup_DV_N_sup_@s.c"
"click","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_autoAcceptTOU_field=autoAcceptTOU::MetaForm:refreshCurrentPage']",""
"click","[@awname='TestStagerForm:runStager']",""
"waitForPageToLoad","360000",""
#Create Buyer
"clickAndWait","[@awname='createTestBuyer::TestCategoryLinks:testUnitClick']",""
"type","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_userId_field=userId::MetaForm:refreshCurrentPage']","selbuy_DV_N_buy_@b.c"
"click","[@awname='class=ariba.network.service.common.anappsbusinesslogic.testutils.TestUserAccountInfo_autoAcceptTOU_field=autoAcceptTOU::MetaForm:refreshCurrentPage']",""
"click","[@awname='TestStagerForm:runStager']",""
"waitForPageToLoad","360000",""
#Create Relationship
"clickAndWait","[@awname='createSupplierBuyerRelationship::TestCategoryLinks:testUnitClick']",""
#wait for supplier / buyer to replicate 
"clickAndWait","[@awname='waitForSupplierToReplicate::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='waitForBuyerToReplicate::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='waitForRelationshipToReplicate::TestCategoryLinks:testUnitClick']",""
#Setting Buyer As context
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentralASN_Buyer']",""
"type","[@awname='ANTestUserManager:newUsername']","selbuy_DV_N_buy_@b.c"
"clickAndWait","[@awname='ANTestUserManager:changeUser']",""
#Navigating To Buyer Home page
#Setting Rule " 	Allow suppliers to include attachments with order confirmations"
"clickAndWait","[@awname='buyerHomePage::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='AribaAction:preferences:actionClicked']",""
"clickAndWait","[@awname='buyerConfig_Transactions']",""
"clickAndWait","[@awname='CBOcAsnSetup:ocAcceptAttachment']",""
"clickAndWait","[@awname='CBInvoiceRuleSetup:checkboxClicked']",""
"clickAndWait","[@awname='CBInvoiceSetup:checkboxClicked']",""
"clickAndWait","[@awname='ModalPageWrapper:okClicked_1']",""
"clickAndWait","[@awname='ModalPageWrapper:okClicked']",""
#set the supplier to the test context
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentralASN_Supplier']",""
"type","[@awname='ANTestUserManager:newUsername']","selsup_DV_N_sup_@s.c"
"clickAndWait","[@awname='ANTestUserManager:changeUser']",""
#PO creation using CXML
"clickAndWait","[@awname='postPOXML::TestCategoryLinks:testUnitClick']",""
"type","[@awname='TestPOPost:poNumber']","PO1_DV_N_foo_"
"type","[@awname='TestPOPost:xmlString']","<?xml version=""1.0"" encoding=""UTF-8""?> <!DOCTYPE cXML SYSTEM ""http://svchf.ariba.com/schemas/cXML/1.2.019/cXML.dtd""> <cXML     payloadID = ""1408606142996555554756756756722-007""     timestamp = ""2014-08-21T00:29:03-07:00""     version = ""1.2.025""     xml:lang = ""en-US"">     <Header>         <From>             <Credential domain = ""NetworkID"">                 <Identity>AN02001158203</Identity>             </Credential>         </From>         <To>             <Credential domain = ""NetworkID"">                 <Identity>AN02001158204</Identity>             </Credential>         </To>         <Sender>             <Credential domain = ""NetworkID"">                 <Identity>AN02001158203</Identity>                 <SharedSecret>welcome</SharedSecret>             </Credential>             <UserAgent>Ariba.com Network V1.0</UserAgent>         </Sender>     </Header>     <Request deploymentMode = ""production"">         <OrderRequest>             <OrderRequestHeader                 orderDate = ""2015-09-30T00:29:03-07:00""                 orderID = ""PO12461""                 orderType = ""regular""                 type = ""new"">                 <Total>                     <Money currency = ""USD"">31.20</Money>                 </Total>                 <ShipTo>                     <Address>                         <Name xml:lang = ""en"">Acme</Name>                         <PostalAddress name = ""default"">                             <DeliverTo>Joe Smith</DeliverTo>                             <DeliverTo>Mailstop M-543</DeliverTo>                             <Street>123 Anystreet</Street>                             <City>Sunnyvale</City>                             <State>CA</State>                             <PostalCode>94089</PostalCode>                             <Country isoCountryCode = ""US"">United States</Country>                         </PostalAddress>                     </Address>                 </ShipTo>                 <BillTo>                     <Address>                         <Name xml:lang = ""en"">Acme</Name>                         <PostalAddress name = ""default"">                             <Street>123 Anystreet</Street>                             <City>Sunnyvale</City>                             <State>CA</State>                             <PostalCode>94089</PostalCode>                             <Country isoCountryCode = ""US"">United States</Country>                         </PostalAddress>                     </Address>                 </BillTo>             </OrderRequestHeader>             <ItemOut                 quantity = ""100""                 lineNumber = ""0001""                 requestedDeliveryDate = ""2009-12-12"">                 <ItemID>                     <SupplierPartID>BB86324203</SupplierPartID>                     <SupplierPartAuxiliaryID>00010</SupplierPartAuxiliaryID>                 </ItemID>                 <ItemDetail>                     <UnitPrice>                         <Money currency = ""USD"">60</Money>                     </UnitPrice>                     <Description xml:lang = ""en"">FILE, 10 IN., FLAT, SMOOTH,</Description>                     <UnitOfMeasure>EA</UnitOfMeasure>                     <Classification domain = ""UNSPSC"">2299</Classification>                     <Extrinsic name = ""receiverAssignedDropZone"">BOP TOOL ROOM</Extrinsic>                     <Extrinsic name = ""recipientID"">JMENEFEE</Extrinsic>                     <Extrinsic name = ""costObjectRequired"">N</Extrinsic>                     <Extrinsic name = ""deliveryReference"">ZZZ</Extrinsic>                     <Extrinsic name = ""requestedDeliveryAtForwarderDate"">20091205</Extrinsic>                     <Extrinsic name = ""chargeNo"">C021883355</Extrinsic>                     <Extrinsic name = ""customersPartNo"">BB86324203</Extrinsic>                     <Extrinsic name = ""serviceTax"">1715</Extrinsic>                     <Extrinsic name = ""educationalCess"">171</Extrinsic>                     <Extrinsic name = ""Need By"">Jan-11-2008</Extrinsic>                     <Extrinsic name = ""hideAmount""/>                     <Extrinsic name = ""hideUnitPrice""/>                 </ItemDetail>                 <Comments xml:lang = ""en"">EQUAL TO NICHOLSON.</Comments>             </ItemOut> <ItemOut                 quantity = ""100""                 lineNumber = ""0002""                 requestedDeliveryDate = ""2009-12-12"">                 <ItemID>                     <SupplierPartID>BB86324203</SupplierPartID>                     <SupplierPartAuxiliaryID>00010</SupplierPartAuxiliaryID>                 </ItemID>                 <ItemDetail>                     <UnitPrice>                         <Money currency = ""USD"">60</Money>                     </UnitPrice>                     <Description xml:lang = ""en"">FILE, 10 IN., FLAT, SMOOTH,</Description>                     <UnitOfMeasure>EA</UnitOfMeasure>                     <Classification domain = ""UNSPSC"">2299</Classification>                     <Extrinsic name = ""receiverAssignedDropZone"">BOP TOOL ROOM</Extrinsic>                     <Extrinsic name = ""recipientID"">JMENEFEE</Extrinsic>                     <Extrinsic name = ""costObjectRequired"">N</Extrinsic>                     <Extrinsic name = ""deliveryReference"">ZZZ</Extrinsic>                     <Extrinsic name = ""requestedDeliveryAtForwarderDate"">20091205</Extrinsic>                     <Extrinsic name = ""chargeNo"">C021883355</Extrinsic>                     <Extrinsic name = ""customersPartNo"">BB86324203</Extrinsic>                     <Extrinsic name = ""serviceTax"">1715</Extrinsic>                     <Extrinsic name = ""educationalCess"">171</Extrinsic>                     <Extrinsic name = ""Need By"">Jan-11-2008</Extrinsic>                     <Extrinsic name = ""hideAmount""/>                     <Extrinsic name = ""hideUnitPrice""/>                 </ItemDetail>                 <Comments xml:lang = ""en"">EQUAL TO NICHOLSON.</Comments>             </ItemOut> <ItemOut                 quantity = ""100""                 lineNumber = ""0003""                 requestedDeliveryDate = ""2009-12-12"">                 <ItemID>                     <SupplierPartID>BB86324203</SupplierPartID>                     <SupplierPartAuxiliaryID>00010</SupplierPartAuxiliaryID>                 </ItemID>                 <ItemDetail>                     <UnitPrice>                         <Money currency = ""USD"">60</Money>                     </UnitPrice>                     <Description xml:lang = ""en"">FILE, 10 IN., FLAT, SMOOTH,</Description>                     <UnitOfMeasure>EA</UnitOfMeasure>                     <Classification domain = ""UNSPSC"">2299</Classification>                     <Extrinsic name = ""receiverAssignedDropZone"">BOP TOOL ROOM</Extrinsic>                     <Extrinsic name = ""recipientID"">JMENEFEE</Extrinsic>                     <Extrinsic name = ""costObjectRequired"">N</Extrinsic>                     <Extrinsic name = ""deliveryReference"">ZZZ</Extrinsic>                     <Extrinsic name = ""requestedDeliveryAtForwarderDate"">20091205</Extrinsic>                     <Extrinsic name = ""chargeNo"">C021883355</Extrinsic>                     <Extrinsic name = ""customersPartNo"">BB86324203</Extrinsic>                     <Extrinsic name = ""serviceTax"">1715</Extrinsic>                     <Extrinsic name = ""educationalCess"">171</Extrinsic>                     <Extrinsic name = ""Need By"">Jan-11-2008</Extrinsic>                     <Extrinsic name = ""hideAmount""/>                     <Extrinsic name = ""hideUnitPrice""/>                 </ItemDetail>                 <Comments xml:lang = ""en"">EQUAL TO NICHOLSON.</Comments>             </ItemOut>             <ItemOut                 lineNumber = ""4""                 quantity = ""200""                 requestedDeliveryDate = ""2008-09-21"">                 <ItemID>                     <SupplierPartID>AX4518</SupplierPartID>                 </ItemID>                 <ItemDetail>                     <UnitPrice>                         <Money currency = ""USD"">31.20</Money>                     </UnitPrice>                     <Description xml:lang = ""en"">BULLNOSE SHELVES 4 PK</Description>                     <UnitOfMeasure>PK</UnitOfMeasure>                     <Classification domain = ""SPSC"">foo</Classification>                     <ManufacturerPartID>AX4518</ManufacturerPartID>                     <ManufacturerName>20008496</ManufacturerName>                 </ItemDetail>                 <SpendDetail>                     <Extrinsic name = ""GenericServiceCategory"">                         <Extrinsic name = ""Some Attribute"">Some Value</Extrinsic>                     </Extrinsic>                 </SpendDetail>                 <Distribution>                     <Accounting name = ""DistributionCharge"">                         <Segment description = ""Entertainment"" id = ""23456"" type = ""G/L Account"" />                         <Segment description = ""Western Region Sales"" id = ""2323"" type = ""Cost Center"" />                     </Accounting>                     <Charge>                         <Money currency = ""USD"">31.20</Money>                     </Charge>                 </Distribution>             </ItemOut>         </OrderRequest>     </Request> </cXML>"
"clickAndWait","[@awname='TestPOPost:uploadXML']",""
#supplier home page
"clickAndWait","[@awname='showDocumentUI::TestCategoryLinks:testUnitClick']",""
"click","[@awname='INSPOActions:refreshCurrentPage']",""
"clickAndWait","[@awname='INSPOActions:updateLineItemStatusClicked']",""
"type","[@awname='___INTERNAL_Order Confirmation Header Quick Entry____INTERNAL_Order Confirmation Header Summary Row_ConfirmationHeader.confirmID::ConfirmationHeader.confirmID']","CNFRM_DV_N_ORDER_"
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.confirmQuantity']",""
"type","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.confirmQuantity']","30"
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.backorderQuantity_1']",""
"type","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.backorderQuantity_1']","40"
"click","[@awname='ItemOut::AWRefreshRegion_8']",""
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.rejectQuantity_2']",""
"type","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.rejectQuantity_2']","10"
"click","[@awname='ItemOut::AWRefreshRegion_8']",""
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.confirmQuantity_3']",""
"type","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.confirmQuantity_3']","70"
"click","[@awname='ItemOut::AWRefreshRegion_10']",""
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals']",""
"typefilename","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals']","testData/LineAttachment.txt"
"clickAndWait","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::TXNGenerateLineAttachment:addAttachmentClicked']",""
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_ItemConfirmationStatus_____INTERNALAW_confirmSomeLineItems::ANTXNLineItemUpdate:context.confirmQuantity_3']",""
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals_1']",""
"typefilename","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals_1']","testData/LineAttachment.txt"
"clickAndWait","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::TXNGenerateLineAttachment:addAttachmentClicked_1']",""
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals_2']",""
"typefilename","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals_2']","testData/LineAttachment.txt"
"clickAndWait","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::TXNGenerateLineAttachment:addAttachmentClicked_2']",""
"click","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals_3']",""
"typefilename","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::AWFileUploadInternals_3']","testData/LineAttachment.txt"
"clickAndWait","[@awname='ItemOut____INTERNAL_descriptionDetail____INTERNAL_OrderConfirmationLineAttachments_____INTERNALAW_attachmentsLineItemEdit::TXNGenerateLineAttachment:addAttachmentClicked_3']",""
"clickAndWait","[@awname='next::WizardNavigator:actionClicked_1']",""
"clickAndWait","[@awname='submit::WizardNavigator:actionClicked']",""
"clickAndWait","[@awname='TXNPageWrapperContent:wrapper.returnPage']",""
#wait for replicate document and Supplier inbox
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentral_']",""
"clickAndWait","[@awname='waitForProcessedDocument::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='Supplier inbox::TestCategoryLinks:testUnitClick']",""
#Moving to verify buyer inbox
"click","[@awname='TestPane:PopupMenuLink']",""
"clickAndWait","[@awname='TestPane:TestCentralASN_Buyer']",""
"type","[@awname='ANTestUserManager:newUsername']","selbuy_DV_N_buy_@b.c"
"clickAndWait","[@awname='ANTestUserManager:changeUser']",""
"clickAndWait","[@awname='Buyer inbox::TestCategoryLinks:testUnitClick']",""
"clickAndWait","[@awname='PTSGlobalTOC:tabClicked_2']",""
"clickAndWait","[@awname='documentNumber::INSPOList:docClicked']",""
